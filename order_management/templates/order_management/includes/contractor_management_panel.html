<!-- 下請け管理パネルモーダル -->
<div class="modal fade" id="contractorManagementModal" tabindex="-1" aria-labelledby="contractorManagementModalLabel" aria-hidden="true" style="z-index: 9999 !important;">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="contractorManagementModalLabel">
                    <i class="fas fa-user-tie"></i> 下請け管理
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">登録下請け業者一覧</h6>
                    <div class="d-flex gap-2">
                        <input type="text" id="contractorSearchInput" class="form-control form-control-sm" placeholder="業者名で検索..." style="width: 250px;">
                        <button type="button" class="btn btn-primary btn-sm" onclick="openAddContractorModal()">
                            <i class="fas fa-plus"></i> 新規追加
                        </button>
                    </div>
                </div>

                <!-- 下請け業者テーブル -->
                <div class="table-responsive">
                    <table class="table table-hover table-sm">
                        <thead class="table-light">
                            <tr>
                                <th style="width: 20%;">業者名</th>
                                <th style="width: 15%;">専門分野</th>
                                <th style="width: 12%;">担当者</th>
                                <th style="width: 15%;">連絡先</th>
                                <th style="width: 18%;">支払いサイクル</th>
                                <th style="width: 8%;" class="text-center">状態</th>
                                <th style="width: 12%;">アクション</th>
                            </tr>
                        </thead>
                        <tbody id="contractorTableBody">
                            <tr>
                                <td colspan="7" class="text-center text-muted">読み込み中...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
            </div>
        </div>
    </div>
</div>

<!-- 業者削除確認モーダル -->
<div class="modal fade" id="deleteContractorModal" tabindex="-1" aria-labelledby="deleteContractorModalLabel" aria-hidden="true" style="z-index: 10000 !important;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="deleteContractorModalLabel">
                    <i class="fas fa-exclamation-triangle me-2"></i>業者の削除
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="mb-3">本当にこの業者を削除しますか？</p>
                <div class="alert alert-warning mb-0">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong id="contractorNameToDelete"></strong>
                    <br>
                    <small>この操作は取り消せません。</small>
                </div>
                <input type="hidden" id="contractorIdToDelete">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>キャンセル
                </button>
                <button type="button" class="btn btn-danger" id="confirmDeleteContractorBtn" onclick="confirmDeleteContractor()">
                    <i class="fas fa-trash me-1"></i>削除する
                </button>
            </div>
        </div>
    </div>
</div>

<!-- 業者編集モーダル -->
<div class="modal fade" id="editContractorModal" tabindex="-1" aria-labelledby="editContractorModalLabel" aria-hidden="true" style="z-index: 10000 !important;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editContractorModalLabel">
                    <i class="fas fa-edit"></i> 業者情報編集
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editContractorForm">
                    <input type="hidden" id="editContractorId">
                    <div class="mb-3">
                        <label for="editContractorName" class="form-label">業者名 <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="editContractorName" required placeholder="例: ○○建設株式会社">
                    </div>
                    <div class="mb-3">
                        <label for="editContractorType" class="form-label">業者種別 <span class="text-danger">*</span></label>
                        <select class="form-select" id="editContractorType" required onchange="toggleEditHourlyRateField()">
                            <option value="">-- 業者種別を選択 --</option>
                            <option value="company">協力会社</option>
                            <option value="individual">個人職人</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="editContractorAddress" class="form-label">住所</label>
                        <input type="text" class="form-control" id="editContractorAddress" placeholder="例: 東京都渋谷区...">
                    </div>
                    <div class="mb-3">
                        <label for="editContractorPhone" class="form-label">電話番号</label>
                        <input type="tel" class="form-control" id="editContractorPhone" placeholder="例: 03-1234-5678">
                    </div>
                    <div class="mb-3">
                        <label for="editContractorEmail" class="form-label">メールアドレス</label>
                        <input type="email" class="form-control" id="editContractorEmail" placeholder="例: info@example.com">
                    </div>
                    <div class="mb-3">
                        <label for="editContractorContactPerson" class="form-label">担当者名</label>
                        <input type="text" class="form-control" id="editContractorContactPerson" placeholder="例: 山田 太郎">
                    </div>
                    <div class="mb-3" id="editHourlyRateField" style="display: none;">
                        <label for="editContractorHourlyRate" class="form-label">時給単価（円）</label>
                        <input type="number" class="form-control" id="editContractorHourlyRate" placeholder="3000" min="0" step="100">
                        <small class="form-text text-muted">任意: コスト計算用（個人職人のみ）</small>
                    </div>
                    <div class="mb-3">
                        <label for="editContractorSpecialties" class="form-label">専門分野</label>
                        <input type="text" class="form-control" id="editContractorSpecialties" placeholder="例: 建築工事、内装工事">
                        <small class="form-text text-muted">任意: カンマ区切りで複数入力可</small>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="editContractorIsActive">
                        <label class="form-check-label" for="editContractorIsActive">
                            アクティブ
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
                <button type="button" class="btn btn-primary" onclick="submitEditContractor()">
                    <i class="fas fa-save"></i> 更新
                </button>
            </div>
        </div>
    </div>
</div>
