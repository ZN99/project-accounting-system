# 建設プロジェクト管理システム 仕様書

**最終更新日:** 2025年11月14日
**バージョン:** 1.0

---

## 目次

1. [システム概要](#システム概要)
2. [実装済み機能](#実装済み機能)
3. [半実装機能（テスト未完了）](#半実装機能テスト未完了)
4. [未実装機能](#未実装機能)
5. [今後の開発予定](#今後の開発予定)

---

## システム概要

本システムは、建設プロジェクトの管理を効率化するためのWebアプリケーションです。
案件の登録から完了までの進捗管理、発注管理、経理機能などを一元管理し、
プロジェクトの可視化と業務効率化を実現します。

**対象ユーザー:**
- 本社スタッフ
- 現場監督者
- 経理担当者
- 協力業者
- 現地調査員（予定）

---

## 実装済み機能

以下の機能は実装およびテストが完了しており、本番環境で使用可能です。

### 1. 案件管理機能 ⭐ **メイン機能**

本システムの中核となる機能で、建設プロジェクトのライフサイクル全体を管理します。

#### 1.1 案件登録
- **新規案件の作成**
  - 案件名、顧客情報、住所、契約金額などの基本情報を登録
  - 案件種別の選択（新築、リフォーム、外構など）
  - 契約日、着工予定日の設定
  - タグによる分類管理

- **柔軟な入力形式**
  - 必須項目と任意項目の明確な区分
  - 入力バリデーション（金額、日付など）
  - エラーメッセージによる入力サポート

#### 1.2 案件一覧表示
- **一覧画面での情報表示**
  - 案件番号、案件名、顧客名、金額
  - 現在のフェーズ（受注前、施工中、完了など）
  - 進捗状況（進捗バーとパーセンテージ）
  - 完了ステップ数/総ステップ数
  - タグ表示

- **次のアクション表示** 🆕
  - 各案件で次に実施すべきアクションを小さく表示
  - 「Next: 〇〇を完了してください」形式
  - NEXTステップの表示（次の次のステップ）

- **検索・絞り込み機能**
  - 案件名、顧客名での検索
  - フェーズ別フィルター
  - タグ別フィルター
  - 日付範囲での絞り込み

- **並び替え機能**
  - 案件番号順
  - 作成日順
  - 更新日順
  - 契約金額順

#### 1.3 案件詳細表示
- **包括的な情報表示**
  - 基本情報セクション
  - 顧客情報セクション
  - 契約・金額情報セクション
  - 進捗情報セクション
  - メモ・備考欄

- **進捗管理の可視化**
  - 全体進捗率の表示
  - フェーズごとの進捗バー
  - ステップ別の完了状況
  - 次のアクション表示（「Next Action:」形式）
  - NEXTステップ表示（「Next Step:」形式）

- **表示モードの切り替え** 🆕
  - タブ表示モード：情報をタブで切り替えて表示
  - 全体表示モード：すべての情報を一度に表示
  - 切り替えボタンで簡単に変更可能

- **関連情報の表示**
  - 材料発注一覧
  - 業者発注一覧
  - 入金履歴
  - 支払履歴

#### 1.4 案件編集
- **情報の更新**
  - すべての基本情報の変更
  - 契約内容の修正
  - メモの追加・編集

- **変更履歴の記録**
  - 更新日時の自動記録
  - 更新者の記録

#### 1.5 案件削除
- **安全な削除機能**
  - 削除確認画面の表示
  - 削除する案件の詳細情報を再確認
  - 誤削除防止のための二重確認

- **関連データの処理**
  - 関連する発注データの処理
  - 関連する経理データの処理

#### 1.6 進捗ステップ管理（動的管理システム）🆕

本システムの特徴的な機能で、プロジェクトごとにカスタマイズ可能な進捗管理を実現します。

- **標準ステップ**
  - 着手：プロジェクトの開始
  - 現調：現地調査の実施
  - 着工：実際の工事開始
  - 完工：工事の完了
  - 引渡：顧客への引き渡し

- **動的ステップ管理の特徴**
  - **ステップの追加**: 案件ごとに独自のステップを追加可能
    - 例：「設計確認」「中間検査」「追加工事」「請求書発行」など
  - **ステップの削除**: 不要なステップの削除
  - **ステップの並び替え**: ドラッグ&ドロップで順序変更
  - **完工後の追加ステップ**: 完工後でも「請求書発行」などのステップを追加可能

- **ステップの状態管理**
  - 予定日の入力
  - 実施日の入力
  - 完了チェックボックス
  - 未完了・完了の視覚的表示

- **自動進捗計算**
  - 完了ステップ数 / 総ステップ数
  - パーセンテージ表示
  - 次のアクションの自動判定
  - NEXTステップの自動表示

- **次のアクションの動的判定** 🆕
  - ステップの状態に応じた適切なアクション提示
    - 「〇〇：予定日を入力してください」
    - 「〇〇：実施日を入力してください」
    - 「〇〇：完了チェックボックスをチェックしてください」
  - ステップが削除・並び替えされても正しく動作
  - 案件詳細画面と案件一覧画面の両方で表示

#### 1.7 フェーズ管理
- **プロジェクトの段階管理**
  - 受注前
  - 施工前
  - 施工中
  - 完了
  - キャンセル

- **フェーズ別の色分け表示**
  - 視覚的に分かりやすいカラーコード
  - アイコンによる識別

#### 1.8 タグ管理
- **柔軟な分類システム**
  - 複数タグの付与
  - タグによる検索・絞り込み
  - タグの色分け表示

### 2. ダッシュボード機能

プロジェクトの全体像を一目で把握できる機能です。

#### 2.1 統計情報の表示
- **案件数統計**
  - 総案件数
  - フェーズ別案件数
  - 月別案件数

- **金額統計**
  - 総契約金額
  - 月別売上
  - 平均案件金額

- **進捗統計**
  - 全体進捗率
  - 完了率
  - 遅延案件数

#### 2.2 グラフ・チャート表示
- **視覚的なデータ表現**
  - 円グラフ：フェーズ別分布
  - 棒グラフ：月別売上
  - 折れ線グラフ：進捗推移

### 3. ユーザー管理機能

システムへのアクセス管理とユーザー権限の制御を行います。

#### 3.1 認証機能
- **ログイン・ログアウト**
  - ユーザー名/パスワード認証
  - セッション管理
  - 自動ログアウト

#### 3.2 権限管理
- **役割ベースのアクセス制御**
  - 管理者（本社スタッフ）
  - 現場監督者
  - 協力業者
  - 閲覧のみユーザー

- **機能別アクセス権限**
  - 案件の作成・編集権限
  - 経理情報の閲覧権限
  - システム設定の変更権限

### 4. 発注管理機能

材料と業者への発注を管理します。

#### 4.1 材料発注
- **発注書の作成**
  - 材料名、数量、単価の入力
  - 発注先の選択
  - 希望納期の設定

- **発注状況の管理**
  - 発注済み
  - 納品済み
  - 検収済み

- **発注履歴の表示**
  - 案件別発注一覧
  - 材料別発注履歴

#### 4.2 業者発注（外注管理）
- **外注発注書の作成**
  - 作業内容の記載
  - 外注先業者の選択
  - 金額の設定

- **外注状況の管理**
  - 発注済み
  - 作業中
  - 完了

### 5. システム基本機能

#### 5.1 レスポンシブデザイン
- **デバイス対応**
  - デスクトップPC
  - タブレット
  - スマートフォン

#### 5.2 データエクスポート
- **帳票出力**
  - PDF形式での出力
  - Excel形式での出力

---

## 半実装機能（テスト未完了）

以下の機能は実装されていますが、十分なテストが完了しておらず、本番環境での使用には注意が必要です。

### 1. 経理機能 ⚠️ **テスト未完了**

経理関連の機能は実装されていますが、データの整合性や計算ロジックの検証が完了していません。

#### 1.1 売掛金・買掛金管理
- **機能概要**
  - 顧客からの入金管理
  - 業者への支払管理
  - 未収金・未払金の把握

- **実装状況**
  - 基本的なCRUD操作は実装済み
  - データ入力画面は完成
  - 一覧表示画面は完成

- **未完了項目**
  - 金額計算の検証不足
  - 案件との紐付けロジックのテスト不足
  - 残高計算の正確性の検証不足
  - エッジケースのテスト未実施

#### 1.2 固定費管理
- **機能概要**
  - 月額固定費の登録
  - 固定費の種別管理（家賃、人件費、光熱費など）
  - 期間指定での固定費管理

- **実装状況**
  - 固定費の登録・編集・削除機能は実装済み
  - 固定費一覧画面は完成
  - 月額・年額計算機能は実装済み

- **未完了項目**
  - 期間計算ロジックの検証不足
  - 統計データとの連携テスト不足
  - 損益計算への反映テスト未実施

#### 1.3 会計レポート
- **機能概要**
  - 月次損益計算書
  - 案件別収支報告
  - キャッシュフロー分析

- **実装状況**
  - レポート画面は実装済み
  - 基本的な集計ロジックは実装済み

- **未完了項目**
  - 集計ロジックの正確性検証不足
  - 複雑な条件でのテスト未実施
  - PDF出力機能のテスト不足

#### 1.4 テストが必要な理由
- 金額計算の正確性は業務上極めて重要
- 誤った金額が表示されると経営判断を誤る可能性
- 税務申告にも影響する可能性
- エッジケース（境界値、特殊条件）での動作確認が必要

---

## 未実装機能

以下の機能は設計のみで、実装されていません。

### 1. 現地調査機能 ❌ **未実装**

現地調査員（フィールドサーベイヤー）向けの機能は完全に未実装です。

#### 1.1 計画されている機能
- **モバイル対応の調査フォーム**
  - スマートフォンでの入力
  - 写真撮影・アップロード
  - 位置情報の記録
  - オフライン対応

- **調査項目の管理**
  - 調査チェックリスト
  - 測定値の入力
  - 現場状況の記録
  - 特記事項の入力

- **調査報告書の自動生成**
  - 入力データからの報告書作成
  - 写真付き報告書
  - PDF出力

- **調査スケジュール管理**
  - 調査予定の登録
  - 調査員への割り当て
  - 調査進捗の追跡

#### 1.2 未実装の理由
- モバイルアプリケーション開発が必要
- オフライン機能の実装が複雑
- 位置情報サービスとの連携が必要
- 開発優先順位が低い

---

## 今後の開発予定

### フェーズ1: 経理機能の完成とテスト（優先度: 高）
- 経理機能の全項目のテスト実施
- 金額計算ロジックの検証
- エッジケースのテスト
- バグ修正と安定化

**推定工数:** 2-3週間

### フェーズ2: 案件管理機能の拡張（優先度: 中）
- 案件複製機能
- 案件テンプレート機能
- 一括操作機能
- より詳細な検索機能

**推定工数:** 2週間

### フェーズ3: レポート機能の強化（優先度: 中）
- カスタムレポート作成
- グラフの種類追加
- データエクスポート機能の拡充
- 印刷レイアウトの最適化

**推定工数:** 1-2週間

### フェーズ4: 現地調査機能の実装（優先度: 低）
- 要件定義の詳細化
- モバイルアプリ開発
- オフライン機能の実装
- テストと調整

**推定工数:** 1-2ヶ月

### フェーズ5: システム全体の最適化（優先度: 低）
- パフォーマンス改善
- セキュリティ強化
- ユーザビリティ改善
- ドキュメント整備

**推定工数:** 2-3週間

---

## 技術情報（参考）

**使用技術:**
- バックエンド: Python / Django
- フロントエンド: HTML, CSS, JavaScript, Bootstrap 5
- データベース: PostgreSQL / SQLite
- その他: jQuery, Font Awesome, Chart.js

**システム要件:**
- Webブラウザ: Chrome, Firefox, Safari, Edge（最新版）
- インターネット接続（クラウド版の場合）

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2025-11-14 | 1.0 | 初版作成 |

---

## 付録: 用語集

- **案件**: 建設プロジェクトの単位
- **フェーズ**: プロジェクトの進行段階
- **ステップ**: フェーズ内の個別タスク
- **売掛金**: 顧客から受け取るべき金額
- **買掛金**: 業者へ支払うべき金額
- **固定費**: 毎月発生する固定的な費用
- **現地調査**: 工事前の現場確認作業
- **外注**: 外部業者への作業委託

---

**問い合わせ先:**
システム管理者まで

---

*本仕様書は2025年11月14日時点の情報に基づいています。*
